{% extends "base.html" %}
{% block content %}
<div class="container mt-4"></div>

<!-- HEADER -->
<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <h1 class="h3 fw-bold">Меню</h1>
        <div class="text-muted">Обирай категорію або шукай страву</div>
    </div>

    <!-- SEARCH -->
    <form class="d-flex" method="get" action="{% url 'menu_list' %}">
        <input class="form-control me-2" type="search" name="q" placeholder="Пошук..." value="{{ q|default:'' }}">
        <button class="btn btn-dark" type="submit">Шукати</button>
    </form>
</div>


<div class="row">

    <!-- ЛІВА КОЛОНКА (категорії) -->
    <div class="col-md-3 mb-3">
        <div class="card">
            <div class="card-header fw-bold">Категорії</div>

            <div class="list-group list-group-flush">

                <!-- ВСІ -->
                <a href="{% url 'menu_list' %}"
                   class="list-group-item list-group-item-action {% if not category %}active{% endif %}">
                    Всі
                </a>

                <!-- СПИСОК -->
                {% for c in categories %}
                    <a href="{% url 'menu_list' %}?cat={{ c.slug }}"
                       class="list-group-item list-group-item-action {% if category == c.slug %}active{% endif %}">
                        {{ c.name }}
                    </a>
                {% empty %}
                    <div class="list-group-item text-muted">Категорій поки немає</div>
                {% endfor %}

            </div>
        </div>
    </div>



    <!-- ПРАВА КОЛОНКА (страви) -->
    <div class="col-md-9">

        <div class="row">

            {% for dish in dishes %}
            <div class="col-md-6 col-lg-4 mb-3">

                <div class="card h-100">

                    <!-- IMAGE -->
                    {% if dish.image %}
                        <a href="{% url 'dish_detail' dish.id %}">
                            <img src="{{ dish.image.url }}" class="card-img-top" style="height:200px;object-fit:cover;">
                        </a>
                    {% endif %}

                    <div class="card-body d-flex flex-column">

                        <!-- TITLE -->
                        <h5 class="card-title">
                            <a href="{% url 'dish_detail' dish.id %}" class="text-decoration-none text-dark">
                                {{ dish.name }}
                            </a>
                        </h5>

                        <!-- DESC -->
                        {% if dish.description %}
                            <p class="card-text text-muted">
                                {{ dish.description|truncatechars:80 }}
                            </p>
                        {% endif %}

                        <!-- PRICE + BUTTON -->
                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <span class="fw-bold">{{ dish.price }} грн</span>

                            <a href="{% url 'cart:add_to_cart' dish.id %}"
                               class="btn btn-primary btn-sm">
                                Додати
                            </a>
                        </div>

                    </div>
                </div>

            </div>
            {% empty %}
                <p class="text-muted">Нічого не знайдено</p>
            {% endfor %}

        </div>
    </div>

</div>

{% endblock %}